---
- name: Process queued service-check action for {{ action.container_name }}
  listen: Process service-check actions
  vars:
    pending_actions: "{{ service_check_pending_actions | default([]) }}"
    handler_context: "{{ action }}"
  when: pending_actions | length > 0
  include_tasks: process_action.yml
  loop: "{{ pending_actions }}"
  loop_control:
    loop_var: action

- name: Clear processed service-check actions
  listen: Process service-check actions
  when: (service_check_pending_actions | default([])) | length > 0
  set_fact:
    service_check_pending_actions: []
